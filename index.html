<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Screen Recorder</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* CSS remain the same as the layout is preserved */
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
  background:#f5f5f5;
  color:#1a1a1a;
  min-height:100vh;
  display:flex;
  overflow-x:hidden;
  overflow-y:auto;
  padding:32px;
  justify-content:center;
  align-items:center; /* Centered vertically as requested */
}
.container{
  width:100%;
  max-width:1400px;
  height: auto;
}
.grid{
  display:grid;
  grid-template-columns:320px 1fr 320px;
  gap:24px;
  align-items:stretch;
  width:100%;
}
.left-sidebar,.center-content,.right-sidebar{
  display:flex;
  flex-direction:column;
}
@media (max-width:1200px){
  .grid{
    grid-template-columns:1fr 320px;
  }
  .left-sidebar{display:none}
}
@media (max-width:768px){
  body{padding:16px}
  .grid{
    grid-template-columns:1fr;
    gap:16px;
  }
  .left-sidebar,.right-sidebar{display:none}
}
.card{
  background:#ffffff;
  border:1px solid #e0e0e0;
  border-radius:12px;
  padding:28px;
  height:100%;
  box-shadow:0 2px 8px rgba(0,0,0,0.04);
  display:flex;
  flex-direction:column;
}
.card-header{
  margin-bottom:24px;
}
.card-title{
  font-size:16px;
  font-weight:600;
  color:#1a1a1a;
  margin-bottom:4px;
  display:flex;
  align-items:center;
  gap:8px;
}
.card-title img{
  width:20px;
  height:20px;
  object-fit:contain;
}
.card-subtitle{
  font-size:13px;
  color:#666666;
}
.status-box{
  background:#f5f5f5;
  border:1px solid #e0e0e0;
  border-radius:8px;
  padding:24px;
  text-align:center;
  margin-bottom:24px;
  transition:all 0.3s ease;
}
.status-box.recording{
  background:#fff9e6;
  border-color:#ffd700;
}
.status-box.stopped{
  background:#e8f5e9;
  border-color:#4caf50;
}
.status-icon{
  margin-bottom:12px;
  display:flex;
  justify-content:center;
  align-items:center;
}
.status-icon img{
  width:48px;
  height:48px;
  object-fit:contain;
}
.status-text{
  font-size:13px;
  font-weight:500;
  color:#666666;
  text-transform:uppercase;
  letter-spacing:0.5px;
}
.timer{
  font-size:56px;
  font-weight:700;
  color:#1a1a1a;
  text-align:center;
  margin-bottom:28px;
  font-variant-numeric:tabular-nums;
  letter-spacing:-2px;
  line-height:1;
}
.control-group{
  display:flex;
  gap:12px;
  margin-bottom:24px;
}
.btn{
  flex:1;
  height:44px;
  border:none;
  border-radius:6px;
  font-size:14px;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  font-family:'Inter',sans-serif;
}
.btn:disabled{
  opacity:0.4;
  cursor:not-allowed;
}
.btn-primary{
  background:#1a1a1a;
  color:#ffffff;
}
.btn-primary:hover:not(:disabled){
  background:#333333;
}
.btn-primary:active:not(:disabled){
  background:#000000;
}
.btn-secondary{
  background:#ffffff;
  color:#1a1a1a;
  border:1px solid #e0e0e0;
}
.btn-secondary:hover:not(:disabled){
  background:#f5f5f5;
  border-color:#d0d0d0;
}
.btn-danger{
  background:#dc3545;
  color:#ffffff;
}
.btn-danger:hover:not(:disabled){
  background:#c82333;
}
.divider{
  height:1px;
  background:#e0e0e0;
  margin:24px 0;
}
.setting-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:16px 0;
  gap:16px;
}
.setting-label{
  display:flex;
  align-items:center;
  gap:10px;
  font-size:14px;
  font-weight:500;
  color:#1a1a1a;
}
.setting-label img{
  width:18px;
  height:18px;
  object-fit:contain;
}
.select{
  height:36px;
  padding:0 12px;
  border:1px solid #e0e0e0;
  border-radius:6px;
  background:#ffffff;
  font-size:14px;
  font-weight:500;
  color:#1a1a1a;
  cursor:pointer;
  font-family:'Inter',sans-serif;
  transition:all 0.2s;
}
.select:hover{
  border-color:#d0d0d0;
}
.select:focus{
  outline:none;
  border-color:#1a1a1a;
}
.preview-container{
  background:#000000;
  border-radius:12px;
  overflow:hidden;
  width:100%;
  min-height:400px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-bottom:20px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  flex:1;
}
.preview-container.empty{
  background:#f5f5f5;
  border:2px dashed #e0e0e0;
}
.preview-placeholder{
  text-align:center;
  color:#999999;
}
.preview-placeholder img{
  width:64px;
  height:64px;
  margin-bottom:12px;
  opacity:0.4;
  object-fit:contain;
}
.preview-placeholder-text{
  font-size:14px;
  font-weight:500;
}
.preview-container video{
  width:100%;
  height:100%;
  object-fit:contain;
}
.info-box{
  background:#f5f5f5;
  border:1px solid #e0e0e0;
  border-radius:8px;
  padding:20px;
  font-size:13px;
  color:#666666;
  line-height:1.7;
  height:100%;
  display:flex;
  flex-direction:column;
}
.info-box strong{
  color:#1a1a1a;
  font-weight:600;
}
.info-section{
  margin-bottom:20px;
}
.info-section:last-child{
  margin-bottom:0;
}
.info-icon{
  display:inline-flex;
  align-items:center;
  gap:6px;
}
.info-icon img{
  width:16px;
  height:16px;
  object-fit:contain;
}
</style>
</head>
<body>

<div class="container">
  <div class="grid">
    <div class="left-sidebar">
      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <img src="assets/video-camera.png" alt="Camera">
            Screen Recorder
          </div>
          <div class="card-subtitle">Record your screen in high quality</div>
        </div>

        <div class="status-box" id="statusBox">
          <div class="status-icon" id="statusIcon">
            <img src="assets/status-ready.png" alt="Ready">
          </div>
          <div class="status-text" id="statusText">Ready to record</div>
        </div>

        <div class="timer" id="timer">00:00:00</div>

        <div class="control-group">
          <button class="btn btn-primary" id="startBtn" onclick="startRecording()">
            <span>▶</span> Start
          </button>
          <button class="btn btn-danger" id="stopBtn" onclick="stopRecording()" disabled>
            <span>⏹</span> Stop
          </button>
        </div>

        <div class="divider"></div>

        <div class="card-header">
          <div class="card-title">
            <img src="assets/settings.png" alt="Settings">
            Video Settings
          </div>
        </div>

        <div class="setting-row">
          <div class="setting-label">
            <img src="assets/monitor.png" alt="Quality">
            Quality
          </div>
          <select class="select" id="qualitySelect" onchange="updateQuality()">
            <option value="720">HD (720p)</option>
            <option value="1080" selected>Full HD (1080p)</option>
            <option value="1440">2K (1440p)</option>
          </select>
        </div>
      </div>
    </div>

    <div class="center-content">
      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <img src="assets/play.png" alt="Preview">
            Preview
          </div>
          <div class="card-subtitle">Your recorded video will appear here</div>
        </div>

        <div class="preview-container empty" id="previewContainer">
          <div class="preview-placeholder">
            <img src="assets/video-camera.png" alt="No Recording">
            <div class="preview-placeholder-text">No recording yet</div>
          </div>
        </div>

        <button class="btn btn-secondary" id="downloadBtn" onclick="downloadVideo()" disabled style="width:100%;height:48px;font-size:15px">
          <img src="assets/download.png" alt="Download" style="width:18px;height:18px">
          Download Recording
        </button>
      </div>
    </div>

    <div class="right-sidebar">
      <div class="info-box">
        <div class="info-section">
          <strong class="info-icon">
            <img src="assets/info.png" alt="Info">
            How it works:
          </strong><br><br>
          
          <strong>Quality Settings:</strong><br>
          • <strong>HD (720p)</strong> - 1280x720 pixels<br>
          • <strong>Full HD (1080p)</strong> - 1920x1080 pixels<br>
          • <strong>2K (1440p)</strong> - 2560x1440 pixels<br><br>
          
          The actual quality depends on your screen's resolution.
        </div>

        <div class="divider"></div>

        <div class="info-section">
          <strong class="info-icon">
            <img src="assets/lock.png" alt="Security">
            Security:
          </strong><br><br>
          All processing happens entirely on your device. Videos are not uploaded to any server.
        </div>

        <div class="divider"></div>

        <div class="info-section">
          <strong class="info-icon">
            <img src="assets/microphone.png" alt="Audio">
            Audio:
          </strong><br><br>
          When you start recording, the browser will ask if you want to share audio. You can choose to enable or disable it.
        </div>
      </div>
    </div>
  </div>
</div>

<script>
let mediaRecorder;
let recordedChunks = [];
let stream;
let timerInterval;
let seconds = 0;

let settings = {
  quality: 1080
};

function updateQuality() {
  settings.quality = parseInt(document.getElementById('qualitySelect').value);
  console.log('Quality changed to:', settings.quality + 'p');
}

function updateTimer() {
  seconds++;
  const hrs = Math.floor(seconds / 3600);
  const mins = Math.floor((seconds % 3600) / 60);
  const secs = seconds % 60;
  
  document.getElementById('timer').textContent = 
    `${String(hrs).padStart(2, '0')}:${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
}

function updateStatus(state, iconSrc, text) {
  const statusBox = document.getElementById('statusBox');
  statusBox.className = `status-box ${state}`;
  document.getElementById('statusIcon').innerHTML = `<img src="${iconSrc}" alt="${text}">`;
  document.getElementById('statusText').textContent = text;
}

async function startRecording() {
  try {
    let width, height;
    switch(settings.quality) {
      case 720:
        width = 1280;
        height = 720;
        break;
      case 1080:
        width = 1920;
        height = 1080;
        break;
      case 1440:
        width = 2560;
        height = 1440;
        break;
      default:
        width = 1920;
        height = 1080;
    }

    const constraints = {
      video: {
        mediaSource: 'screen',
        width: { ideal: width },
        height: { ideal: height },
        frameRate: { ideal: 30 }
      },
      audio: true
    };

    console.log('Starting recording with:', constraints);
    
    stream = await navigator.mediaDevices.getDisplayMedia(constraints);
    
    const videoTrack = stream.getVideoTracks()[0];
    const actualSettings = videoTrack.getSettings();
    console.log('Actual video settings:', actualSettings);
    console.log('Resolution:', actualSettings.width + 'x' + actualSettings.height);
    
    const options = { mimeType: 'video/webm;codecs=vp9,opus' };
    if (!MediaRecorder.isTypeSupported(options.mimeType)) {
      options.mimeType = 'video/webm';
    }
    
    mediaRecorder = new MediaRecorder(stream, options);
    recordedChunks = [];
    
    mediaRecorder.ondataavailable = (event) => {
      if (event.data.size > 0) {
        recordedChunks.push(event.data);
      }
    };
    
    mediaRecorder.onstop = () => {
      const blob = new Blob(recordedChunks, { type: 'video/webm' });
      const url = URL.createObjectURL(blob);
      
      const container = document.getElementById('previewContainer');
      container.className = 'preview-container';
      container.innerHTML = '<video controls></video>';
      container.querySelector('video').src = url;
      
      window.recordedBlob = blob;
      document.getElementById('downloadBtn').disabled = false;
      
      updateStatus('stopped', 'assets/status-completed.png', 'Recording completed');
      
      stream.getTracks().forEach(track => track.stop());
    };
    
    stream.getVideoTracks()[0].onended = () => {
      if (mediaRecorder.state === 'recording') {
        stopRecording();
      }
    };
    
    mediaRecorder.start();
    
    updateStatus('recording', 'assets/status-recording.png', 'Recording in progress');
    document.getElementById('startBtn').disabled = true;
    document.getElementById('stopBtn').disabled = false;
    
    seconds = 0;
    updateTimer();
    timerInterval = setInterval(updateTimer, 1000);
    
  } catch (error) {
    console.error('Error:', error);
    alert('Cannot start recording. Please grant screen access permission.');
    updateStatus('', 'assets/status-ready.png', 'Ready to record');
    document.getElementById('startBtn').disabled = false;
    document.getElementById('stopBtn').disabled = true;
  }
}

function stopRecording() {
  if (mediaRecorder && mediaRecorder.state === 'recording') {
    mediaRecorder.stop();
    clearInterval(timerInterval);
    document.getElementById('startBtn').disabled = false;
    document.getElementById('stopBtn').disabled = true;
  }
}

function downloadVideo() {
  if (window.recordedBlob) {
    const url = URL.createObjectURL(window.recordedBlob);
    const a = document.createElement('a');
    a.style.display = 'none';
    a.href = url;
    
    const now = new Date();
    const timestamp = now.toISOString().replace(/[:.]/g, '-').slice(0, -5);
    a.download = `screen-recording-${settings.quality}p-${timestamp}.webm`;
    
    document.body.appendChild(a);
    a.click();
    
    setTimeout(() => {
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }, 100);
  }
}
</script>

</body>
</html>